<ion-header>
  <ion-navbar>

    <ion-title>{{currentSituation.name}} situation</ion-title>

    <ion-buttons right>

      <button ion-button padding *ngIf="pregenerateBtn" class="btnPregenerate" (click)="pregenerateItems()">
        Pregenerate items
      </button>

      <button ion-button *ngIf="isActive" class="btnTrash">
        <ion-icon name="trash" color="danger"></ion-icon>
      </button>

    </ion-buttons>

  </ion-navbar>

  <ion-toolbar>
    <ion-grid>
      <ion-row>

        <ion-col (click)="togglePopover('persons')">
          <ion-buttons>
            <button ion-button color="light">
              <ion-icon padding name="person" color="danger"></ion-icon>
              Add Person
            </button>
          </ion-buttons>
        </ion-col>

        <ion-col (click)="togglePopover('moods')">
          <ion-buttons>
            <button ion-button color="light">
              <ion-icon padding name="happy" color="danger"></ion-icon>
              Add Mood
            </button>
          </ion-buttons>
        </ion-col>

        <ion-col (click)="togglePopover('items')">
          <ion-buttons>
            <button ion-button color="light">
              <ion-icon padding name="football" color="danger"></ion-icon>
              Add Item
            </button>
          </ion-buttons>
        </ion-col>

      </ion-row>
    </ion-grid>

  </ion-toolbar>


  <ion-list *ngIf="togglePersons" [ngClass]="animationClasses">
    <div *ngFor="let popItem of db.popoverPersons" >
      <img 
        [src]="popItem.imgUrl" 
        [class]="popItem.category" 
        (touchstart)="moveStart(popItem, $event)" 
        (touchmove)="moveDragOver(popItem, $event)" 
        (touchend)="addToSituation(popItem, currentSituation, $event)"
        (dblclick)="addToSituationToDefaultPosition(popItem, currentSituation, $event)" />
    </div>
  </ion-list>


  <ion-list *ngIf="toggleMoods" [ngClass]="animationClasses">
    <div *ngFor="let popItem of db.popoverMoods">
      <img 
        [src]="popItem.imgUrl" 
        [class]="popItem.category" 
        (touchstart)="moveStart(popItem, $event)" 
        (touchmove)="moveDragOver(popItem, $event)" 
        (touchend)="addToSituation(popItem, currentSituation, $event)"
        (dblclick)="addToSituationToDefaultPosition(popItem, currentSituation, $event)" />
    </div>
  </ion-list>


  <ion-list *ngIf="toggleItems" [ngClass]="animationClasses">
    <div  *ngFor="let popItem of db.popoverItems">
      <img 
        [src]="popItem.imgUrl" 
        [class]="popItem.category" 
        (touchstart)="moveStart(popItem, $event)" 
        (touchmove)="moveDragOver(popItem, $event)" 
        (touchend)="addToSituation(popItem, currentSituation, $event)"
        (dblclick)="addToSituationToDefaultPosition(popItem, currentSituation, $event)" />
    </div>
  </ion-list>


</ion-header>



<ion-content 
  [class]="allowScroll" 
  (touchmove)="moveDragOver(item, $event)" 
  (touchend)="moveDrop(item, $event)" 
  (click)="closePopup()">

  <div class="situationItems">
    <div *ngFor="let item of sceneItems" 
      [class]="item.category" 
      (touchstart)="moveStart(item, $event)" 
      (dblclick)="makeActive($event)" 
      [style.left]="item.x + 'px'" 
      [style.top]="item.y + 'px'" >

      <ion-icon 
        *ngIf="isActive && item.category !='background'" 
        name="close-circle" 
        color="danger"
        class="ion-ios-close" 
        (click)="removeItemFromScene(item)" >
      </ion-icon>

      <img [src]="item.imgUrl" [class]="item.category" />

    </div>
  </div>

</ion-content>
